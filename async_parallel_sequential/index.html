<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    
    <title>éåŒæ­¥çš„ Parallel &amp; Seqential | å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾</title>

    <meta name="description" content="&lt;p&gt;åœ¨è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æ™‚å€™ï¼Œå¤§è‡´ä¸Šæœƒåˆ†ç‚ºä½µç™¼ (Parallel) å’Œåºåˆ— (Sequential) åŸ·è¡Œå…©ç¨®æƒ…æ³ã€‚&lt;br&gt;æœ¬æ–‡å°‡æœƒå¾å¸¸è¦‹çš„æ‡‰ç”¨é‚è¼¯åˆ‡å…¥ï¼Œå…ˆé‡æ¸… Javascript è£¡é¢ Async Function çš„æ¦‚å¿µï¼Œé€²è€Œæ¢ç©¶åºåˆ—éåŒæ­¥çš„æ ¸å¿ƒï¼Œæœ€å¾Œè¼”ä»¥ Event Loop ä½œç‚ºåœ–åƒåŒ–çš„è§£é‡‹ã€‚&lt;/p&gt;">
    <meta name="keywords" content="">

    

    <meta property="og:locale" content="en" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content= "éåŒæ­¥çš„ Parallel &amp; Seqential | å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾"  />
    <meta property="og:description" content= "&lt;p&gt;åœ¨è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æ™‚å€™ï¼Œå¤§è‡´ä¸Šæœƒåˆ†ç‚ºä½µç™¼ (Parallel) å’Œåºåˆ— (Sequential) åŸ·è¡Œå…©ç¨®æƒ…æ³ã€‚&lt;br&gt;æœ¬æ–‡å°‡æœƒå¾å¸¸è¦‹çš„æ‡‰ç”¨é‚è¼¯åˆ‡å…¥ï¼Œå…ˆé‡æ¸… Javascript è£¡é¢ Async Function çš„æ¦‚å¿µï¼Œé€²è€Œæ¢ç©¶åºåˆ—éåŒæ­¥çš„æ ¸å¿ƒï¼Œæœ€å¾Œè¼”ä»¥ Event Loop ä½œç‚ºåœ–åƒåŒ–çš„è§£é‡‹ã€‚&lt;/p&gt;" />
    <meta property="og:url" content="http://example.com/async_parallel_sequential/index.html" />
    <meta property="og:site_name" content="" />
    <meta property="article:author" content="Dalian Wang" />
    <meta property="article:publisher" content="" />
    <meta property="og:description" content="&lt;p&gt;åœ¨è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æ™‚å€™ï¼Œå¤§è‡´ä¸Šæœƒåˆ†ç‚ºä½µç™¼ (Parallel) å’Œåºåˆ— (Sequential) åŸ·è¡Œå…©ç¨®æƒ…æ³ã€‚&lt;br&gt;æœ¬æ–‡å°‡æœƒå¾å¸¸è¦‹çš„æ‡‰ç”¨é‚è¼¯åˆ‡å…¥ï¼Œå…ˆé‡æ¸… Javascript è£¡é¢ Async Function çš„æ¦‚å¿µï¼Œé€²è€Œæ¢ç©¶åºåˆ—éåŒæ­¥çš„æ ¸å¿ƒï¼Œæœ€å¾Œè¼”ä»¥ Event Loop ä½œç‚ºåœ–åƒåŒ–çš„è§£é‡‹ã€‚&lt;/p&gt;" />
    <meta name="twitter:title" content="éåŒæ­¥çš„ Parallel &amp; Seqential | å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾"/>
    <meta name="twitter:description" content="&lt;p&gt;åœ¨è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æ™‚å€™ï¼Œå¤§è‡´ä¸Šæœƒåˆ†ç‚ºä½µç™¼ (Parallel) å’Œåºåˆ— (Sequential) åŸ·è¡Œå…©ç¨®æƒ…æ³ã€‚&lt;br&gt;æœ¬æ–‡å°‡æœƒå¾å¸¸è¦‹çš„æ‡‰ç”¨é‚è¼¯åˆ‡å…¥ï¼Œå…ˆé‡æ¸… Javascript è£¡é¢ Async Function çš„æ¦‚å¿µï¼Œé€²è€Œæ¢ç©¶åºåˆ—éåŒæ­¥çš„æ ¸å¿ƒï¼Œæœ€å¾Œè¼”ä»¥ Event Loop ä½œç‚ºåœ–åƒåŒ–çš„è§£é‡‹ã€‚&lt;/p&gt;"/>
    <script type="application/ld+json">
        {
            "description": "&lt;p&gt;åœ¨è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æ™‚å€™ï¼Œå¤§è‡´ä¸Šæœƒåˆ†ç‚ºä½µç™¼ (Parallel) å’Œåºåˆ— (Sequential) åŸ·è¡Œå…©ç¨®æƒ…æ³ã€‚&lt;br&gt;æœ¬æ–‡å°‡æœƒå¾å¸¸è¦‹çš„æ‡‰ç”¨é‚è¼¯åˆ‡å…¥ï¼Œå…ˆé‡æ¸… Javascript è£¡é¢ Async Function çš„æ¦‚å¿µï¼Œé€²è€Œæ¢ç©¶åºåˆ—éåŒæ­¥çš„æ ¸å¿ƒï¼Œæœ€å¾Œè¼”ä»¥ Event Loop ä½œç‚ºåœ–åƒåŒ–çš„è§£é‡‹ã€‚&lt;/p&gt;",
            "author": { "@type": "Person", "name": "Dalian Wang" },
            "@type": "BlogPosting",
            "url": "http://example.com/async_parallel_sequential/index.html",
            "publisher": {
            "@type": "Organization",
            "logo": {
                "@type": "ImageObject",
                "url": "http://example.comundefined"
            },
            "name": "Dalian Wang"
            },
            "headline": "éåŒæ­¥çš„ Parallel &amp; Seqential | å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾",
            "datePublished": "2022-07-17T15:49:23.000Z",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "http://example.com/async_parallel_sequential/index.html"
            },
            "@context": "http://schema.org"
        }
    </script>




    

    

    

    

    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¢</text></svg>">
    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1654266144177.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1654266144177.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            
        }
        window.aomori_logo_typed_animated = false
        window.aomori_search_algolia = false

    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3FXMCYL94W"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3FXMCYL94W');
    </script>

<meta name="generator" content="Hexo 6.2.0"></head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-inner">
                
                    <a class="header-type-title" href="/">å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾</a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">Home</a>
                
                <a href="/archives">Archives</a>
                
                <a href="/tags">Tags</a>
                
                <a href="/about">About</a>
                
            </div>
            <div class="header-menu-social">
                
            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">Home</a>
                    
                    <a href="/archives">Archives</a>
                    
                    <a href="/tags">Tags</a>
                    
                    <a href="/about">About</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-cl68syqs100035x5r9iru3nf5" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      éåŒæ­¥çš„ Parallel &amp; Seqential
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2022-07-17T15:49:23.000Z" itemprop="datePublished">2022-07-17</time>
</div>

            

            
            <div class="article-tag">
                <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E8%A1%93%E4%BA%A4%E6%B5%81/" rel="tag">æŠ€è¡“äº¤æµ</a></li></ul>
            </div>
            

            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <p>åœ¨è™•ç†å¤šå€‹éåŒæ­¥æ“ä½œçš„æ™‚å€™ï¼Œå¤§è‡´ä¸Šæœƒåˆ†ç‚ºä½µç™¼ (Parallel) å’Œåºåˆ— (Sequential) åŸ·è¡Œå…©ç¨®æƒ…æ³ã€‚<br>æœ¬æ–‡å°‡æœƒå¾å¸¸è¦‹çš„æ‡‰ç”¨é‚è¼¯åˆ‡å…¥ï¼Œå…ˆé‡æ¸… Javascript è£¡é¢ Async Function çš„æ¦‚å¿µï¼Œé€²è€Œæ¢ç©¶åºåˆ—éåŒæ­¥çš„æ ¸å¿ƒï¼Œæœ€å¾Œè¼”ä»¥ Event Loop ä½œç‚ºåœ–åƒåŒ–çš„è§£é‡‹ã€‚</p>
<span id="more"></span>

<p><img src="https://images.unsplash.com/photo-1432753759888-b30b2bdac995?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2953&q=80"></p>
<h2 id="Parallel-æœ€å¸¸è¦‹çš„æ‡‰ç”¨"><a href="#Parallel-æœ€å¸¸è¦‹çš„æ‡‰ç”¨" class="headerlink" title="Parallel æœ€å¸¸è¦‹çš„æ‡‰ç”¨"></a>Parallel æœ€å¸¸è¦‹çš„æ‡‰ç”¨</h2><p>å…ˆä¾†çœ‹ä¸€æ®µç¨‹å¼ç¢¼ï¼š</p>
<pre><code class="javascript=">const arr = [1, 2, 3];
const printAfterOneSecond = (value) =&gt;
  new Promise(() =&gt;
    setTimeout(() =&gt; &#123;
      console.log(value);
    &#125;, 1000)
  );
arr.forEach((a) =&gt; printAfterOneSecond(a));
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ä¸€ç§’å¾ŒæœƒåŒæ™‚å°å‡ºé™£åˆ—è£¡æ‰€æœ‰çš„å…ƒç´ ã€‚</p>
<p>åœ¨å¯¦å‹™ä¸Šé€šå¸¸æœƒæ­é…ç°¡æ½”çš„ Array Method ä¾†æ“ä½œï¼Œä»¥é”åˆ°åŒæ™‚åŸ·è¡Œå¤šå€‹éåŒæ­¥çš„æ•ˆæœã€‚é€™ç¨®æƒ…æ³æˆ‘å€‘ç¨±ä½œä½µç™¼ (Parallel)ã€‚</p>
<hr>
<p>å¦‚æœè¦è«‡åˆ°éåŒæ­¥ï¼ŒAPI é¡å‹çš„ AJAX æ“ä½œå¤§æ¦‚æ˜¯æœ€å¸¸è¦‹çš„æ‡‰ç”¨ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ï¼Œæ¨¡æ“¬åŒæ™‚åŸ·è¡Œå¤šå€‹ AJAX Request çš„çµæœã€‚ç‚ºäº†æ–¹ä¾¿è¬›è§£ï¼Œåƒ…å°‡å›å‚³çš„çµæœå°å‡ºè€Œä¸å„²å­˜ã€‚</p>
<pre><code class="javascript=">// åˆ©ç”¨ç€è¦½å™¨çš„ setTimeout æ¨¡æ“¬ response
const getData = (value) =&gt;
  new Promise((res) =&gt;
    setTimeout(() =&gt; &#123;
      res(value);
    &#125;, 1000 * Math.random())
  );

const arr = [1, 2, 3];

const getAllData = async () =&gt; &#123;
  await Promise.all(
    arr.map((a) =&gt;
      getData(a).then((result) =&gt; &#123;
        console.log(result);
      &#125;)
    )
  );
  console.log(&#39;done!&#39;);
&#125;;

/* getAllData(); */
</code></pre>
<iframe width="50%" height="300" src="//jsfiddle.net/dalian_bigface/by6wh1m0/21/embedded/result,js/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>

<p>å› ç‚º Response å›å‚³çš„æ™‚é–“æ˜¯ä»‹æ–¼ 0~1000ms çš„ä¸€å€‹éš¨æ©Ÿæ•¸ï¼Œåœ¨åŒæ™‚ç™¼é€ Request çš„æƒ…æ³ä¸‹ï¼Œå…ˆå®Œæˆçš„ Promise å°±æœƒå…ˆè¼¸å‡º Resolve å€¼ã€‚</p>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œåˆ©ç”¨ Parallel çš„æ–¹å¼åŒæ™‚åŸ·è¡Œå¤šæ”¯ API æ™‚ï¼Œæ˜¯ç„¡æ³•ä¿è­‰å®Œæˆé †åº &#x3D; é™£åˆ—å…ƒç´ é †åºçš„ã€‚</p>
<p>ä½†å¦‚æœæˆ‘ä»Šå¤©æƒ³è¦ä¸€å€‹ä¸€å€‹ç…§é †åºä¾†å‘¢ï¼Ÿ</p>
<h2 id="ä¸è¦å¿˜è¨˜-Async-Function-çš„æœ¬è³ª"><a href="#ä¸è¦å¿˜è¨˜-Async-Function-çš„æœ¬è³ª" class="headerlink" title="ä¸è¦å¿˜è¨˜ Async Function çš„æœ¬è³ª"></a>ä¸è¦å¿˜è¨˜ Async Function çš„æœ¬è³ª</h2><p>ä½ å¯èƒ½æœƒæƒ³èªªï¼Œåœ¨éåŒæ­¥å‹•ä½œ <code>getData</code> çš„å‰é¢åŠ ä¸Š <code>await</code>ï¼Œæ‡‰è©²å°±å¯ä»¥è§£æ±ºé€™å€‹å•é¡Œäº†å§ï¼Ÿ</p>
<p>å¾ˆä¸å¹¸çš„æ˜¯ï¼Œçµæœæœƒå‡ºç¾é€™å€‹éŒ¯èª¤ï¼š<br><img src="https://i.imgur.com/Wg6HmPr.png"></p>
<p>ä¹‹æ‰€ä»¥æœƒå‡ºéŒ¯ï¼Œæ˜¯å› ç‚º <code>.map</code> è£¡é¢çš„åƒæ•¸æ˜¯ä¸€å€‹ Callback Functionã€‚</p>
<p>ä¹Ÿå°±æ˜¯èªªå‰›å‰›åŠ é€²å»çš„ <b><code>await</code> ä¸¦ä¸å±¬æ–¼ <code>getAllData</code> é€™å€‹ Async Function çš„ä¸€éƒ¨ä»½ï¼Œè€Œæ˜¯åœ¨ Callback Function çš„ä½œç”¨åŸŸè£¡</b>ã€‚</p>
<p>å› ç‚ºåŸæœ¬çš„ Callback Function ä¸¦ä¸æ˜¯éåŒæ­¥çš„ï¼Œæ‰€ä»¥åœ¨è£¡é¢ä½¿ç”¨ <code>await</code> é€™å€‹èªæ³•ï¼Œè‡ªç„¶è€Œç„¶å°±æœƒå‡ºç¾éŒ¯èª¤ã€‚</p>
<hr>
<p>å¦‚æœä½ èªç‚ºæŠŠ callback æ”¹æˆéåŒæ­¥å°±èƒ½ä¿®å¾©éŒ¯èª¤ä¸¦è®“ APIs è®Šæˆ sequentially åŸ·è¡Œï¼Œè®“æˆ‘å€‘æŠŠ API çš„ç¯„ä¾‹å†ç°¡åŒ–ä¸€ä¸‹ï¼š</p>
<ol>
<li><p>æ‰€æœ‰ Promise éƒ½å®Œæˆå¾Œä¸è¦å°å‡ºã€Œdone!ã€ã€‚</p>
</li>
<li><p>å› ç‚ºæ‰€æœ‰ Promise éƒ½å®Œæˆå¾Œä¸éœ€è¦å†åšå…¶ä»–äº‹ï¼ŒåŠ ä¸Šæˆ‘å€‘åªéœ€è¦å–®ç´”åœ°å°‡çµæœè¼¸å‡ºï¼Œæˆ‘å€‘å¯ä»¥æŠŠå¤–å±¤çš„ <code>getAllData</code> è½‰è®Šæˆä¸€èˆ¬çš„åŒæ­¥å‡½å¼ï¼Œä¸¦æŠŠ <code>.map</code> æ”¹æˆ <code>.forEach</code>ï¼Œå¦‚ sol A æ‰€ç¤ºã€‚</p>
</li>
<li><p>åŒæ™‚ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨ Async Function æ‹†è§£ Promise Chainï¼Œå°‡ sol A æ”¹å¯«æˆ sol Bã€‚</p>
</li>
</ol>
<pre><code class="javascript=">// sol A
const getAllData = () =&gt; &#123;
  arr.forEach((a) =&gt; &#123;
    getData(a).then((result) =&gt; &#123;
      console.log(result);
    &#125;)
  &#125;);
&#125;;

// sol B
const getAllData = () =&gt; &#123;
  arr.forEach(async (a) =&gt; &#123;
    const result = await getData(a);
    console.log(result);
  &#125;);
&#125;;
</code></pre>
<p>å¦‚æœä½ æ¸…æ¥š Async Function çš„æ¦‚å¿µï¼Œå°±æœƒçŸ¥é“é€™å…©æ®µç¨‹å¼ç¢¼æ˜¯ä»£è¡¨åŒä¸€ä»¶äº‹æƒ…ã€‚</p>
<p>ä¹Ÿå°±æ˜¯èªªæŠŠ callback æ”¹æˆéåŒæ­¥ï¼Œä¸¦ä¸æœƒå½±éŸ¿åŸæœ¬ parallel çš„è¼¸å‡ºçµæœï¼Œåªæ˜¯æ”¹è®Šå¯«æ³•ï¼Œåˆ©ç”¨ <code>async</code>&#x2F;<code>await</code> è®“ callback è®Šå¾—æ›´ç°¡æ½”è€Œå·²ã€‚</p>
<p>åˆæˆ–æ˜¯èªªï¼Œä½¿ç”¨ <code>.forEach</code>&#x2F;<code>.map</code> é€™é¡çš„é™£åˆ—è™•ç†æ–¹æ³•åŸ·è¡ŒéåŒæ­¥å‹•ä½œï¼Œå¿…å®šæœƒæ˜¯ parallelly åŸ·è¡Œã€‚</p>
<hr>
<p>æ‰€ä»¥æˆ‘å€‘å¯ä»¥ç”¨éåŒæ­¥çš„æ–¹å¼æ”¹å¯«åŸæœ¬çš„ç¯„ä¾‹ï¼š</p>
<pre><code class="javascript=">const getAllData = async () =&gt; &#123;
  await Promise.all(
    arr.map(async (a) =&gt; &#123;
      const result = await getData(a);
      console.log(result);
    &#125;)
  );
  console.log(&#39;done!&#39;);
&#125;;
</code></pre>
<p>å› ç‚º <b> <code>getData</code> å‰é¢çš„ <code>await</code> ä¸¦ä¸å±¬æ–¼ <code>getAllData</code> é€™å€‹ Async Function çš„ä¸€éƒ¨ä»½ï¼Œè€Œæ˜¯åœ¨ Callback Function çš„ä½œç”¨åŸŸè£¡ã€‚</b>æ‰€ä»¥æ”¹å¯«éå¾Œä¾èˆŠæ˜¯ parallelly åœ°åŸ·è¡Œã€‚</p>
<h2 id="çœŸæ­£çš„-Sequential"><a href="#çœŸæ­£çš„-Sequential" class="headerlink" title="çœŸæ­£çš„ Sequential"></a>çœŸæ­£çš„ Sequential</h2><p>é€™é‚Šçš„ä¸‰ç¨®å¯«æ³•ï¼Œå¾Œè€…å…¶å¯¦å°±æ˜¯å‰è€…å¯«æ³•çš„åŸå‹ã€‚</p>
<ol>
<li>async&#x2F;await</li>
<li>promise chaining</li>
<li>nested callbacks</li>
</ol>
<h3 id="è®“-await-ç™¼æ®ä½œç”¨"><a href="#è®“-await-ç™¼æ®ä½œç”¨" class="headerlink" title="è®“ await ç™¼æ®ä½œç”¨"></a>è®“ await ç™¼æ®ä½œç”¨</h3><p>å› ç‚º <code>.forEach</code> è£¡é¢æœƒå¸¶ä¸€å€‹ Callback Function åšç‚ºåƒæ•¸ï¼Œæ—¢ç„¶æˆ‘å€‘ä¸èƒ½åœ¨ Async Function è£¡é¢ä½¿ç”¨ <code>await</code> å»æ­é… <code>.forEach</code>ï¼Œé‚£æˆ‘å€‘å°±ä¸è¦ä½¿ç”¨ <code>.forEach</code> å»è¿­ä»£é™£åˆ—ã€‚</p>
<p>å›æ­¸æœ€åŸå§‹çš„ <code>for</code> Loop å¯«æ³•ï¼Œå¯ä»¥é †åˆ©åœ°å’Œå¤–å±¤çš„ Async Function ä¸€èµ·é‹ä½œï¼Œé”åˆ° sequential åŸ·è¡Œçš„æ•ˆæœã€‚åä¹‹ï¼Œå¦‚æœä¸æ­é… <code>async</code>&#x2F;<code>await</code> ä½¿ç”¨ï¼Œå‰‡æ˜¯æœƒè®Šå› parallel åŸ·è¡Œçš„æ•ˆæœã€‚</p>
<pre><code class="javascript=">// for
const getAllData = async () =&gt; &#123;
  for (let i = 0; i &lt; arr.length; i++) &#123;
    const result = await getData(arr[i]);
    console.log(result);
  &#125;
  console.log(&quot;done!&quot;);
&#125;;

// for-in
const getAllData = async () =&gt; &#123;
  for (const i in arr) &#123;
    const result = await getData(arr[i]);
    console.log(result);
  &#125;
  console.log(&quot;done!&quot;);
&#125;;

// for-of
const getAllData = async () =&gt; &#123;
  for (const a of arr) &#123;
    const result = await getData(a);
    console.log(result);
  &#125;
  console.log(&quot;done!&quot;);
&#125;;

// for-await-of
const getAllData = async () =&gt; &#123;
  const promises = arr.map((a) =&gt; getData(a));
  for await (const result of promises) &#123;
    console.log(result);
  &#125;
  console.log(&quot;done!&quot;);
&#125;;
</code></pre>
<h3 id="Promise-Chaining"><a href="#Promise-Chaining" class="headerlink" title="Promise Chaining"></a>Promise Chaining</h3><p>ç¬¬ä¸€å€‹æ–¹æ³•ä¸»è¦æ˜¯é€éåœ¨ Async Function è£¡é¢ä½¿ç”¨å¤šå€‹ <code>await</code> ä¾†é”æˆä¾åºåŸ·è¡Œçš„æ•ˆæœã€‚ç„¶è€Œé€™å€‹å¯«æ³•çš„åŸå‹å…¶å¯¦æ˜¯ä¾†è‡ªæ–¼ Promise Chainã€‚</p>
<p>å‰é¢æœ‰èªªéç”¨ <code>.forEach</code>&#x2F;<code>.map</code> ç­‰é™£åˆ—è™•ç†æ–¹æ³•ä¾†åŸ·è¡ŒéåŒæ­¥æ“ä½œå¿…å®šæœƒæ˜¯ Parallelï¼Œä¸éå…¶å¯¦æœ‰ä¸€å€‹ä¾‹å¤–ï¼š<code>.reduce</code>ã€‚</p>
<p>æˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>.reduce</code> ä¾†å¯¦ä½œ Promise Chain çš„æ¦‚å¿µï¼Œä¾†è®“ç¨‹å¼ç¢¼ä¸æœƒéæ–¼å†—é•·ã€‚</p>
<pre><code class="javascript=">const getAllData = async () =&gt; &#123;
  await arr.reduce(
    (acc, cur) =&gt;
      acc.then(() =&gt;
        getData(cur).then((res) =&gt; &#123;
          console.log(res);
        &#125;)
      ),
    Promise.resolve()
  );
  console.log(&quot;done!&quot;);
&#125;;
</code></pre>
<p>å°‡ callback æ”¹å¯«æˆ Async Functionï¼ˆä½ çµ‚ç©¶è¦ç”¨ async çš„ï¼Œç‚ºä»€éº¼ä¸ç¾åœ¨å°±ç”¨ï¼‰</p>
<pre><code class="javascript=">const getAllData = async () =&gt; &#123;
  await arr.reduce(async (acc, cur) =&gt; &#123;
    await acc;
    const res = await getData(cur);
    console.log(res);
    return res;
  &#125;, Promise.resolve());
  console.log(&quot;done!&quot;);
&#125;;
</code></pre>
<h3 id="å·¢ç‹€-Callback"><a href="#å·¢ç‹€-Callback" class="headerlink" title="å·¢ç‹€ Callback"></a>å·¢ç‹€ Callback</h3><p>åœ¨ç¬¬äºŒç¨®è§£æ³•æˆ‘å€‘ä½¿ç”¨åˆ°äº† Promise Chain çš„æ¦‚å¿µã€‚ç„¶è€Œé€™ç¨®å¯«æ³•ä¹‹æ‰€ä»¥å­˜åœ¨ï¼Œå‰‡æ˜¯ç‚ºäº†è§£æ±ºå¤šå€‹éåŒæ­¥çš„å·¢ç‹€çµæ§‹å‘¼å«å®¹æ˜“é€ æˆ Callback Hell çš„å•é¡Œã€‚</p>
<p>æˆ‘å€‘å¯ä»¥åˆ©ç”¨éè¿´ (Recursive) çš„æ¦‚å¿µï¼Œè®“éåŒæ­¥çš„ç¨‹å¼ç¢¼ä¸è¦åŒ…é‚£éº¼å¤šå±¤ã€‚</p>
<pre><code class="javascript=">const getRecursiveData = (array, index) =&gt; &#123;
  return getData(arr[index]).then((res) =&gt; &#123;
    console.log(res);
    if (index + 1 === array.length) return;
    return getRecursiveData(array, index + 1);
  &#125;);
&#125;;
const getAllData = () =&gt; &#123;
  getRecursiveData(arr, 0).then(() =&gt; &#123;
    console.log(&quot;done!&quot;);
  &#125;);
&#125;;
</code></pre>
<p>å…¶ä¸­çš„ <code>.then</code> ä¸€æ¨£èƒ½æ”¹å¯«æˆ <code>Async Function</code>ï¼Œé€™é‚Šå°±ä¸å†é‡è¤‡ã€‚</p>
<h2 id="ç”¨-Event-Loop-çš„è§’åº¦çœ‹"><a href="#ç”¨-Event-Loop-çš„è§’åº¦çœ‹" class="headerlink" title="ç”¨ Event Loop çš„è§’åº¦çœ‹"></a>ç”¨ Event Loop çš„è§’åº¦çœ‹</h2><p>æœ‰äººå¯èƒ½æœƒæƒ³èªª Javascript ä¸æ˜¯å–®ä¸€åŸ·è¡Œç·’çš„èªè¨€å—ï¼Ÿparallel åŸ·è¡Œåˆæ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿ<br>é€™å€‹å•é¡Œæˆ‘å€‘å¯ä»¥ç”¨ Event Loop çš„æ¦‚å¿µä¾†è§£é‡‹ã€‚ï¼ˆè©³æƒ…è«‹è¦‹ Philip Roberts çš„<a target="_blank" rel="noopener" href="https://youtu.be/8aGhZQkoFbQ">é€™å€‹å½±ç‰‡</a>ï¼‰</p>
<p>ç°¡å–®ä¾†èªªå°±æ˜¯ï¼šéåŒæ­¥æ“ä½œä¸¦ä¸æ˜¯åœ¨ main thread ä¸Šè¢« Javascript åŸ·è¡Œçš„ã€‚</p>
<p>Javascript åœ¨åŸ·è¡Œæ™‚è‹¥é‡åˆ°éåŒæ­¥å‹•ä½œçš„æƒ…æ³ï¼Œç‚ºäº†ä¸è¦é€ æˆé˜»å¡å°±æœƒå°‡ä»–å¾ call stack ç§»é–‹ï¼Œå¾è€Œå¾—ä»¥ç¹¼çºŒåœ¨ main thread ä¸ŠåŸ·è¡Œå…¶ä»–æ“ä½œã€‚</p>
<p><img src="/images/event_loop.gif" alt="event_loop"></p>
<p>é€™é‚Šæœ‰å…©å€‹å€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ol>
<li>å¯ä»¥çœ‹åˆ° JS çš„ç¢ºæœƒä¾åºåŸ·è¡Œé™£åˆ—è£¡çš„å…ƒç´ ï¼Œä¸éå› ç‚º main thread åƒ…è² è²¬å°‡ AJAX requests æ”¾å…¥ Web APIsï¼Œä¸¦æ²’æœ‰ç›´æ¥åŸ·è¡Œï¼Œç•¶ç„¶ä¹Ÿä¸éœ€è¦èŠ±æ™‚é–“ç­‰å¾…ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥è¦–ç‚ºåŒæ™‚ trigger å¤šå€‹ AJAX requestsã€‚</li>
<li>å‡è¨­æˆ‘éœ€è¦åœ¨æ‹¿åˆ° response å¾Œå°‡çµæœå°å‡ºï¼Œå¦‚ä¸Šæ–¹ç¯„ä¾‹ï¼Œé€™å€‹éåŒæ­¥å‹•ä½œæœƒå¸¶ä¸€å€‹ callbackã€‚ä»¥ XMLHttpRequest ä¾†èªªå°±æ˜¯ <code>onload</code>ï¼ŒFetch API å‰‡æ˜¯ Promise çš„ <code>.then</code> æˆ– <code>.catch</code>ã€‚å¦å¤–ï¼Œè‹¥ä»Šå¤©ä¸æ˜¯ parallel è€Œæ˜¯ sequential çš„æƒ…æ³ï¼Œé‚£éº¼ä¸‹ä¸€å€‹å³å°‡åŸ·è¡Œçš„éåŒæ­¥å‹•ä½œä¹Ÿæœƒè¢«åŒ…å«åœ¨é€™å€‹ callback è£¡é¢ã€‚</li>
</ol>
<h2 id="çµèª"><a href="#çµèª" class="headerlink" title="çµèª"></a>çµèª</h2><p>ç¤™æ–¼ç¯‡å¹…çš„ç·£æ•…ï¼Œå¾ˆå¤šè§€å¿µåªèƒ½é»åˆ°ç‚ºæ­¢ï¼Œç”šè‡³éœ€è¦çœç•¥ä¸€äº›éƒ¨åˆ†ã€‚ï¼ˆä¾‹å¦‚æœ¬æ–‡æ²’æåˆ°çš„ <code>generator</code>ï¼Œä¹Ÿæ˜¯å¸¸å¸¸æ‡‰ç”¨æ–¼éåŒæ­¥æ“ä½œçš„ä¸€ç¨®èªæ³•ï¼‰</p>
<p>å¦å¤–å°±æ˜¯ï¼Œæœ¬æ–‡çš„ API ç¯„ä¾‹ç‚ºäº†æ–¹ä¾¿è¬›è§£ï¼Œç°¡åŒ–äº†éå¸¸å¤šæ­¥é©Ÿã€‚å¯¦å‹™ä¸Šé‡å°éåŒæ­¥è™•ç†é€™å€‹å•é¡Œå‰‡æœƒæœ‰æ›´å¤šéœ€è¦åˆ—å…¥è€ƒé‡çš„é …ç›®ï¼Œå¦‚æ¢ä»¶åˆ¤æ–·ã€response å¦‚ä½•å„²å­˜ã€error handling ç­‰ç­‰ã€‚é€™éƒ¨åˆ†å°±æœƒå› ç‚ºæ¥­å‹™é‚è¼¯çš„ä¸åŒè€Œç”¢ç”Ÿéå¸¸å¤šå¯«æ³•ä¸Šçš„è®ŠåŒ–ã€‚</p>
<p>ç¸½è€Œè¨€ä¹‹å°±æ˜¯ï¼ŒéåŒæ­¥çš„ä¸–ç•Œé‚„æœ‰å¾ˆå¤šæ±è¥¿æ­£åœ¨ç­‰è‘—å¤§å®¶å»æ¢ç´¢ï¼</p>
<h2 id="å¾Œè¨˜"><a href="#å¾Œè¨˜" class="headerlink" title="å¾Œè¨˜"></a>å¾Œè¨˜</h2><p>å…¶å¯¦æœƒå¯«é€™ç¯‡ä¸€é–‹å§‹åªæ˜¯å› ç‚ºå·¥ä½œä¸Šç¢°å·§æœ‰é‡åˆ° sequential çš„æƒ…æ³ï¼Œéç¨‹ä¸­æ„å¤–åœ°ç™¼ç¾äº†è‡ªå·±éå¾€çš„ä¸€äº›ç›²é»ï¼Œæ‰€ä»¥æƒ³è¨˜éŒ„ä¸€ä¸‹è§£æ±ºé€™å€‹å•é¡Œçš„æ€è·¯ï¼Œå–®ç´”åœ°è®“è‡ªå·±ä¹‹å¾Œèƒ½å¤ å†æ¬¡è¤‡ç¿’ã€‚</p>
<p>èª°çŸ¥é“åœ¨å †ç Œæ–‡å­—çš„éç¨‹ä¸­ï¼Œç«Ÿä¸è‡ªè¦ºåœ°å°‡è‡ªå·±å¸¶å…¥ä¸€å€‹åˆ†äº«è€…çš„è§’è‰²ã€‚æœ‰æ™‚å€™ç”šè‡³é‚„æœƒæƒ³ï¼šã€Œå¦‚æœä¹Ÿèƒ½æ°å·§åœ°å¹«åŠ©åˆ°å’Œæˆ‘ä¸€æ¨£æœ‰ç›¸åŒç›²é»çš„æœ‹å‹ï¼Œé‚£å°±å¤ªå¥½äº†ï¼ã€</p>
<p>å› æ­¤è‹¥å…§å®¹æœ‰éœ€è¦èª¿æ•´çš„åœ°æ–¹ï¼Œæˆ–èªç‚ºæ€éº¼å¯«æœƒæ›´å®¹æ˜“è®“äººç†è§£ï¼Œä»»ä½•çš„æ„è¦‹å›é¥‹éƒ½æ­¡è¿å’Œæˆ‘è¯çµ¡ï¼Œä¸€åŒäº¤æµè®“å½¼æ­¤æ›´é€²æ­¥ï¼</p>

        </div>

    </div>

    

    

    

    

    

    
<nav class="article-nav">
  
  
    <a href="/front-end-interview/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">ä¸Šä¸€ç¯‡</div>
      <div class="article-nav-title">å‰ç«¯å·¥ç¨‹å¸«é¢è©¦å¿ƒå¾—</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">åˆ†äº«</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=éåŒæ­¥çš„ Parallel & Seqential - å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾&url=http%3A%2F%2Fexample.com%2Fasync_parallel_sequential%2F">
            <ion-icon name="logo-twitter"></ion-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=éåŒæ­¥çš„ Parallel & Seqential - å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾&u=http%3A%2F%2Fexample.com%2Fasync_parallel_sequential%2F">
            <ion-icon name="logo-facebook"></ion-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=éåŒæ­¥çš„ Parallel & Seqential - å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾&url=http://example.com/async_parallel_sequential/&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>
















</div>
                </section>
            </section>

            
            <aside class="sidebar ">
                


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%83%E5%BE%97%E5%88%86%E4%BA%AB/" rel="tag">å¿ƒå¾—åˆ†äº«</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E8%A1%93%E4%BA%A4%E6%B5%81/" rel="tag">æŠ€è¡“äº¤æµ</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/async_parallel_sequential/">éåŒæ­¥çš„ Parallel &amp; Seqential</a>
          </li>
        
          <li>
            <a href="/front-end-interview/">å‰ç«¯å·¥ç¨‹å¸«é¢è©¦å¿ƒå¾—</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <!-- Please do not remove this -->
    <!-- å¼€æºä¸æ˜“ï¼Œè¯·å‹¿åˆ é™¤ -->
    <div class="footer-wrap">
        <div class="footer-inner"> 
            å¤§è‡‰èˆ‡å“ˆç‡’å‡ºç‰ˆç¤¾ &copy; 2022<br>
            Powered By Hexo Â· Theme By <a href="https://linhong.me/" target="_blank">Aomori</a> Â· <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Github</a>
        </div>
    </div>

</footer>

<script type="module" src="https://unpkg.com/ionicons@6.0.2/dist/ionicons/ionicons.esm.js"></script>






<script src="/dist/build.js?1654266144177.js"></script>


<script src="/dist/custom.js?1654266144177.js"></script>













</body>

</html>